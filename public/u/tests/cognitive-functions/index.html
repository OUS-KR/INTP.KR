<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>인지 기능 테스트 - INTP의 모든 것</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <style>
        body {
            background-color: #f4f7f9;
            color: #333;
        }
        #quiz-container {
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 700px;
            margin: 60px auto;
            overflow: hidden;
            text-align: center;
        }
        .progress-bar-container { width: 100%; background-color: #e9ecef; }
        .progress-bar { width: 0; height: 10px; background-color: #4a90e2; transition: width 0.3s ease; }
        #quiz-content, #result-content { padding: 30px 40px; }
        #quiz-content h2 { color: #2c3e50; margin-top: 0; }
        .question { font-size: 1.2em; margin-bottom: 20px; min-height: 50px; }
        .answers { list-style: none; padding: 0; margin: 0; }
        .answer { background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-bottom: 10px; cursor: pointer; transition: background-color 0.2s, border-color 0.2s; }
        .answer:hover { background-color: #e9ecef; border-color: #adb5bd; }
        #result-container { display: none; }
        .result-title { font-size: 1.8em; font-weight: bold; color: #2c3e50; margin-bottom: 25px; }
        .chart-container { margin-bottom: 30px; }
        .chart-bar { display: flex; align-items: center; margin-bottom: 10px; font-size: 0.9em; }
        .chart-label { width: 80px; text-align: right; padding-right: 10px; font-weight: bold; color: #555; }
        .chart-bar-inner { height: 25px; background-color: #4a90e2; width: 0; transition: width 1s ease-out; border-radius: 3px; text-align: right; padding-right: 5px; color: white; line-height: 25px; font-size: 0.8em; }
        .result-analysis { text-align: left; line-height: 1.7; }
        #retry-btn { background-color: #4a90e2; color: white; border: none; border-radius: 8px; padding: 15px 25px; font-size: 1em; cursor: pointer; transition: background-color 0.2s; margin-top: 20px; }
        #retry-btn:hover { background-color: #357abd; }
    </style>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <h1 class="site-title">INTP: The Thinker's Hub</h1>
            <nav class="main-nav">
                <ul>
                    <li><a href="../index.html">홈</a></li>
                    <li class="dropdown">
                        <a href="../intp-explained/index.html">INTP 탐구</a>
                        <ul class="dropdown-menu">
                            <li><a href="../intp-explained/cognitive-functions/index.html">인지 기능</a></li>
                            <li><a href="../intp-explained/subtypes/index.html">하위 유형</a></li>
                            <li><a href="../intp-explained/relationships/index.html">관계와 사회성</a></li>
                            <li><a href="../intp-explained/career/index.html">커리어와 성장</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="../tests.html">심리 테스트</a>
                        <ul class="dropdown-menu">
                            <li><a href="../tendency/index.html">INTP 성향 테스트</a></li>
                            <li><a href="./index.html">인지 기능 테스트</a></li>
                        </ul>
                    </li>
                    <li><a href="../resources/index.html">자료실</a></li>
                </ul>
            </nav>
            <button id="theme-toggle" class="theme-toggle-btn">🌙</button>
        </div>
    </header>

    <main class="site-main">
        <div id="quiz-container">
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div id="quiz-content">
                <h2>인지 기능 테스트</h2>
                <p class="question" id="question"></p>
                <ul class="answers" id="answers"></ul>
            </div>
            <div id="result-container">
                 <div id="result-content">
                    <h2 class="result-title">테스트 결과</h2>
                    <div class="chart-container" id="chart-container"></div>
                    <div class="result-analysis" id="result-analysis"></div>
                    <button id="retry-btn">다시하기</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 INTP Hub. All rights reserved.</p>
        </div>
    </footer>

    <script>
        const quizData = [
            { question: "더 끌리는 활동은?", answers: [ { text: "새로운 아이디어나 가능성을 탐색하고 연결하기", func: "Ne" }, { text: "미래의 비전이나 통찰에 집중하고 패턴을 파악하기", func: "Ni" } ] },
            { question: "결정을 내릴 때, 당신의 주된 기준은?", answers: [ { text: "보편적인 진리나 논리적 원칙에 부합하는가", func: "Ti" }, { text: "효율적이고, 목표 달성에 가장 효과적인 방법인가", func: "Te" } ] },
            { question: "스트레스 상황에서 당신의 반응은?", answers: [ { text: "과거의 안정적인 기억이나 익숙한 감각에 기댄다", func: "Si" }, { text: "현재의 물리적 환경에 몰입하며 즉각적인 행동을 취한다", func: "Se" } ] },
            { question: "타인과 관계를 맺을 때, 더 중요한 것은?", answers: [ { text: "나의 진실한 감정과 가치관을 지키는 것", func: "Fi" }, { text: "그룹의 조화와 유대감을 유지하는 것", func: "Fe" } ] },
            { question: "새로운 정보를 접했을 때, 당신의 반응은?", answers: [ { text: "정보를 여러 관점에서 비틀어보고, 다양한 가능성을 상상한다", func: "Ne" }, { text: "정보의 핵심 의미를 파악하고, 미래에 어떻게 될지 예측한다", func: "Ni" } ] },
            { question: "일을 처리하는 방식은?", answers: [ { text: "나만의 방식으로 분석하고, 가장 논리적인 시스템을 구축한다", func: "Ti" }, { text: "객관적인 사실과 데이터를 기반으로, 체계적으로 일을 조직하고 실행한다", func: "Te" } ] },
            { question: "휴식을 취하는 방식은?", answers: [ { text: "익숙하고 편안한 환경에서, 과거의 좋았던 경험을 되새긴다", func: "Si" }, { text: "새로운 맛집, 액티비티 등 오감을 만족시키는 경험을 찾아 나선다", func: "Se" } ] },
            { question: "갈등 상황에서 당신이 가장 힘든 점은?", answers: [ { text: "나의 신념과 다른 의견을 받아들여야 하는 것", func: "Fi" }, { text: "나 때문에 조직의 분위기가 나빠지는 것", func: "Fe" } ] },
            { question: "대화할 때 당신의 스타일은?", answers: [ { text: "한 주제에서 다른 주제로 자유롭게 넘나들며 아이디어를 확장한다", func: "Ne" }, { text: "하나의 주제를 깊이 파고들어, 그 본질과 미래를 통찰한다", func: 'Ni' } ] },
            { question: "문제를 해결할 때, 당신의 접근 방식은?", answers: [ { text: "문제의 근본 원리를 파악하고, 내적 논리에 따라 완벽하게 이해하려 한다", func: "Ti" }, { text: "목표를 설정하고, 가장 빠르고 효율적인 절차를 만들어 해결한다", func: "Te" } ] },
            { question: "과거를 돌아볼 때, 주로 무엇을 떠올리는가?", answers: [ { text: "그때 느꼈던 주관적인 감각이나 인상, 교훈", func: "Si" }, { text: "현재를 즐기기 위한 수단일 뿐, 과거에 얽매이지 않는다", func: "Se" } ] },
            { question: "당신이 '좋은 사람'이라고 생각하는 기준은?", answers: [ { text: "자신의 가치관과 진정성을 지키는 사람", func: "Fi" }, { text: "타인을 배려하고, 공동체에 기여하는 사람", func: "Fe" } ] }
        ];

        let currentQuestionIndex = 0;
        const scores = { Ne: 0, Ni: 0, Te: 0, Ti: 0, Se: 0, Si: 0, Fe: 0, Fi: 0 };

        const questionEl = document.getElementById('question');
        const answersEl = document.getElementById('answers');
        const quizContentEl = document.getElementById('quiz-content');
        const resultContainerEl = document.getElementById('result-container');
        const chartContainerEl = document.getElementById('chart-container');
        const resultAnalysisEl = document.getElementById('result-analysis');
        const progressBar = document.getElementById('progressBar');
        const retryBtn = document.getElementById('retry-btn');

        function shuffleArray(array) { /* Fisher-Yates shuffle */
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function loadQuiz() {
            const currentQuestion = quizData[currentQuestionIndex];
            questionEl.innerText = currentQuestion.question;
            answersEl.innerHTML = '';
            const shuffledAnswers = shuffleArray([...currentQuestion.answers]);
            shuffledAnswers.forEach(answer => {
                const li = document.createElement('li');
                li.classList.add('answer');
                li.innerText = answer.text;
                li.addEventListener('click', () => selectAnswer(answer.func));
                answersEl.appendChild(li);
            });
            updateProgressBar();
        }

        function selectAnswer(func) {
            scores[func] += 10; // Add points to the selected function
            currentQuestionIndex++;
            if (currentQuestionIndex < quizData.length) {
                loadQuiz();
            } else {
                showResults();
            }
        }
        
        function updateProgressBar() {
            const progress = ((currentQuestionIndex) / quizData.length) * 100;
            progressBar.style.width = progress + '%';
        }

        function showResults() {
            quizContentEl.style.display = 'none';
            resultContainerEl.style.display = 'block';
            progressBar.style.width = '100%';

            // 1. Display Chart
            chartContainerEl.innerHTML = '';
            const sortedScores = Object.entries(scores).sort(([,a],[,b]) => b-a);
            const maxScore = sortedScores[0][1] > 0 ? sortedScores[0][1] : 1; // Avoid division by zero

            sortedScores.forEach(([func, score]) => {
                const percentage = (score / maxScore) * 100;
                const barHtml = `
                    <div class="chart-bar">
                        <div class="chart-label">${func}</div>
                        <div class="chart-bar-inner" style="width: 0%;" data-width="${percentage}">${score}</div>
                    </div>
                `;
                chartContainerEl.innerHTML += barHtml;
            });

            // Animate bars
            setTimeout(() => {
                document.querySelectorAll('.chart-bar-inner').forEach(bar => {
                    bar.style.width = bar.dataset.width + '%';
                });
            }, 100);

            // 2. Display Analysis
            const primaryFunc = sortedScores[0][0];
            const secondaryFunc = sortedScores[1][0];
            resultAnalysisEl.innerHTML = `
                <p>당신의 주기능은 <strong>${primaryFunc}</strong>, 부기능은 <strong>${secondaryFunc}</strong>일 가능성이 높습니다.</p>
                <p>이 테스트는 간이 테스트이며, 정확한 결과는 전문적인 검사를 통해 확인해야 합니다. 각 기능에 대한 자세한 설명은 'INTP 탐구' 메뉴를 참고하세요.</p>
            `;
        }

        function retryQuiz() {
            currentQuestionIndex = 0;
            for (const key in scores) { scores[key] = 0; }
            resultContainerEl.style.display = 'none';
            quizContentEl.style.display = 'block';
            loadQuiz();
        }

        retryBtn.addEventListener('click', retryQuiz);

        loadQuiz();
    </script>
</body>
</html>
